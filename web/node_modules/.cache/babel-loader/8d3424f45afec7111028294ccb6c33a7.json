{"remainingRequest":"E:\\console\\web\\node_modules\\babel-loader\\lib\\index.js!E:\\console\\web\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\console\\web\\src\\utils\\request.js","dependencies":[{"path":"E:\\console\\web\\src\\utils\\request.js","mtime":1629377582278},{"path":"E:\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1629377571573},{"path":"E:\\console\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":1629377569839},{"path":"E:\\console\\web\\node_modules\\eslint-loader\\index.js","mtime":1629377574113}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9NZXNzYWdlQm94MiBmcm9tICJlbGVtZW50LXVpL2xpYi90aGVtZS1jaGFsay9tZXNzYWdlLWJveC5jc3MiOwppbXBvcnQgImVsZW1lbnQtdWkvbGliL3RoZW1lLWNoYWxrL2Jhc2UuY3NzIjsKaW1wb3J0IF9NZXNzYWdlQm94IGZyb20gImVsZW1lbnQtdWkvbGliL21lc3NhZ2UtYm94IjsKaW1wb3J0IF9NZXNzYWdlMiBmcm9tICJlbGVtZW50LXVpL2xpYi90aGVtZS1jaGFsay9tZXNzYWdlLmNzcyI7CmltcG9ydCAiZWxlbWVudC11aS9saWIvdGhlbWUtY2hhbGsvYmFzZS5jc3MiOwppbXBvcnQgX01lc3NhZ2UgZnJvbSAiZWxlbWVudC11aS9saWIvbWVzc2FnZSI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7IC8vIOW8leWFpWF4aW9zCgppbXBvcnQgeyBzdG9yZSB9IGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgY29udGV4dCBmcm9tICdAL21haW4nOwp2YXIgc2VydmljZSA9IGF4aW9zLmNyZWF0ZSh7CiAgYmFzZVVSTDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9CQVNFX0FQSSwKICB0aW1lb3V0OiA5OTk5OQp9KTsKdmFyIGFjaXR2ZUF4aW9zID0gMDsKdmFyIHRpbWVyOwoKdmFyIHNob3dMb2FkaW5nID0gZnVuY3Rpb24gc2hvd0xvYWRpbmcoKSB7CiAgYWNpdHZlQXhpb3MrKzsKCiAgaWYgKHRpbWVyKSB7CiAgICBjbGVhclRpbWVvdXQodGltZXIpOwogIH0KCiAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgIGlmIChhY2l0dmVBeGlvcyA+IDApIHsKICAgICAgY29udGV4dC4kYnVzLmVtaXQoJ3Nob3dMb2FkaW5nJyk7CiAgICB9CiAgfSwgNDAwKTsKfTsKCnZhciBjbG9zZUxvYWRpbmcgPSBmdW5jdGlvbiBjbG9zZUxvYWRpbmcoKSB7CiAgYWNpdHZlQXhpb3MtLTsKCiAgaWYgKGFjaXR2ZUF4aW9zIDw9IDApIHsKICAgIGNsZWFyVGltZW91dCh0aW1lcik7CiAgICBjb250ZXh0LiRidXMuZW1pdCgnY2xvc2VMb2FkaW5nJyk7CiAgfQp9OyAvLyBodHRwIHJlcXVlc3Qg5oum5oiq5ZmoCgoKc2VydmljZS5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoZnVuY3Rpb24gKGNvbmZpZykgewogIGlmICghY29uZmlnLmRvbk5vdFNob3dMb2FkaW5nKSB7CiAgICBzaG93TG9hZGluZygpOwogIH0KCiAgdmFyIHRva2VuID0gc3RvcmUuZ2V0dGVyc1sndXNlci90b2tlbiddOwogIHZhciB1c2VyID0gc3RvcmUuZ2V0dGVyc1sndXNlci91c2VySW5mbyddOwogIGNvbmZpZy5kYXRhID0gSlNPTi5zdHJpbmdpZnkoY29uZmlnLmRhdGEpOwogIGNvbmZpZy5oZWFkZXJzID0gewogICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICd4LXRva2VuJzogdG9rZW4sCiAgICAneC11c2VyLWlkJzogdXNlci5JRAogIH07CiAgcmV0dXJuIGNvbmZpZzsKfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgY2xvc2VMb2FkaW5nKCk7CgogIF9NZXNzYWdlKHsKICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgIG1lc3NhZ2U6IGVycm9yLAogICAgdHlwZTogJ2Vycm9yJwogIH0pOwoKICByZXR1cm4gZXJyb3I7Cn0pOyAvLyBodHRwIHJlc3BvbnNlIOaLpuaIquWZqAoKc2VydmljZS5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXNwb25zZSkgewogIGNsb3NlTG9hZGluZygpOwoKICBpZiAocmVzcG9uc2UuaGVhZGVyc1snbmV3LXRva2VuJ10pIHsKICAgIHN0b3JlLmNvbW1pdCgndXNlci9zZXRUb2tlbicsIHJlc3BvbnNlLmhlYWRlcnNbJ25ldy10b2tlbiddKTsKICB9CgogIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT09IDAgfHwgcmVzcG9uc2UuaGVhZGVycy5zdWNjZXNzID09PSAndHJ1ZScpIHsKICAgIHJldHVybiByZXNwb25zZS5kYXRhOwogIH0gZWxzZSB7CiAgICBfTWVzc2FnZSh7CiAgICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgICAgbWVzc2FnZTogcmVzcG9uc2UuZGF0YS5tc2cgfHwgZGVjb2RlVVJJKHJlc3BvbnNlLmhlYWRlcnMubXNnKSwKICAgICAgdHlwZTogcmVzcG9uc2UuaGVhZGVycy5tc2d0eXBlIHx8ICdlcnJvcicKICAgIH0pOwoKICAgIGlmIChyZXNwb25zZS5kYXRhLmRhdGEgJiYgcmVzcG9uc2UuZGF0YS5kYXRhLnJlbG9hZCkgewogICAgICBzdG9yZS5jb21taXQoJ3VzZXIvTG9naW5PdXQnKTsKICAgIH0KCiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5tc2cgPyByZXNwb25zZS5kYXRhIDogcmVzcG9uc2U7CiAgfQp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICBjbG9zZUxvYWRpbmcoKTsKCiAgX01lc3NhZ2VCb3guY29uZmlybSgiXG4gICAgPHA+XHU2OEMwXHU2RDRCXHU1MjMwXHU2M0E1XHU1M0UzXHU5NTE5XHU4QkVGIi5jb25jYXQoZXJyb3IsICI8L3A+XG4gICAgPHA+XHU5NTE5XHU4QkVGXHU3ODAxNTAwXHVGRjFBXHU2QjY0XHU3QzdCXHU5NTE5XHU4QkVGXHU1MTg1XHU1QkI5XHU1RTM4XHU4OUMxXHU0RThFXHU1NDBFXHU1M0YwcGFuaWNcdUZGMENcdTU5ODJcdTY3OUNcdTVGNzFcdTU0Q0RcdTYwQThcdTZCNjNcdTVFMzhcdTRGN0ZcdTc1MjhcdTUzRUZcdTVGM0FcdTUyMzZcdTc2N0JcdTUxRkFcdTZFMDVcdTc0MDZcdTdGMTNcdTVCNTg8L3A+XG4gICAgPHA+XHU5NTE5XHU4QkVGXHU3ODAxNDA0XHVGRjFBXHU2QjY0XHU3QzdCXHU5NTE5XHU4QkVGXHU1OTFBXHU0RTNBXHU2M0E1XHU1M0UzXHU2NzJBXHU2Q0U4XHU1MThDXHVGRjA4XHU2MjE2XHU2NzJBXHU5MUNEXHU1NDJGXHVGRjA5XHU2MjE2XHU4MDA1XHU4QkY3XHU2QzQyXHU4REVGXHU1Rjg0XHVGRjA4XHU2NUI5XHU2Q0Q1XHVGRjA5XHU0RTBFYXBpXHU4REVGXHU1Rjg0XHVGRjA4XHU2NUI5XHU2Q0Q1XHVGRjA5XHU0RTBEXHU3QjI2PC9wPlxuICAgICIpLCAn5o6l5Y+j5oql6ZSZJywgewogICAgZGFuZ2Vyb3VzbHlVc2VIVE1MU3RyaW5nOiB0cnVlLAogICAgZGlzdGluZ3Vpc2hDYW5jZWxBbmRDbG9zZTogdHJ1ZSwKICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn5riF55CG57yT5a2YJywKICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognCiAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICBzdG9yZS5jb21taXQoJ3VzZXIvTG9naW5PdXQnKTsKICB9KTsKCiAgcmV0dXJuIGVycm9yOwp9KTsKZXhwb3J0IGRlZmF1bHQgc2VydmljZTs="},{"version":3,"sources":["E:/console/web/src/utils/request.js"],"names":["axios","store","context","service","create","baseURL","process","env","VUE_APP_BASE_API","timeout","acitveAxios","timer","showLoading","clearTimeout","setTimeout","$bus","emit","closeLoading","interceptors","request","use","config","donNotShowLoading","token","getters","user","data","JSON","stringify","headers","ID","error","showClose","message","type","response","commit","code","success","msg","decodeURI","msgtype","reload","confirm","dangerouslyUseHTMLString","distinguishCancelAndClose","confirmButtonText","cancelButtonText","then"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB,C,CAA0B;;AAE1B,SAASC,KAAT,QAAsB,SAAtB;AACA,OAAOC,OAAP,MAAoB,QAApB;AAGA,IAAMC,OAAO,GAAGH,KAAK,CAACI,MAAN,CAAa;AAC3BC,EAAAA,OAAO,EAAEC,OAAO,CAACC,GAAR,CAAYC,gBADM;AAE3BC,EAAAA,OAAO,EAAE;AAFkB,CAAb,CAAhB;AAIA,IAAIC,WAAW,GAAG,CAAlB;AACA,IAAIC,KAAJ;;AACA,IAAMC,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxBF,EAAAA,WAAW;;AACX,MAAIC,KAAJ,EAAW;AACTE,IAAAA,YAAY,CAACF,KAAD,CAAZ;AACD;;AACDA,EAAAA,KAAK,GAAGG,UAAU,CAAC,YAAM;AACvB,QAAIJ,WAAW,GAAG,CAAlB,EAAqB;AACnBR,MAAAA,OAAO,CAACa,IAAR,CAAaC,IAAb,CAAkB,aAAlB;AACD;AACF,GAJiB,EAIf,GAJe,CAAlB;AAKD,CAVD;;AAYA,IAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzBP,EAAAA,WAAW;;AACX,MAAIA,WAAW,IAAI,CAAnB,EAAsB;AACpBG,IAAAA,YAAY,CAACF,KAAD,CAAZ;AACAT,IAAAA,OAAO,CAACa,IAAR,CAAaC,IAAb,CAAkB,cAAlB;AACD;AACF,CAND,C,CAOA;;;AACAb,OAAO,CAACe,YAAR,CAAqBC,OAArB,CAA6BC,GAA7B,CACE,UAAAC,MAAM,EAAI;AACR,MAAI,CAACA,MAAM,CAACC,iBAAZ,EAA+B;AAC7BV,IAAAA,WAAW;AACZ;;AACD,MAAMW,KAAK,GAAGtB,KAAK,CAACuB,OAAN,CAAc,YAAd,CAAd;AACA,MAAMC,IAAI,GAAGxB,KAAK,CAACuB,OAAN,CAAc,eAAd,CAAb;AACAH,EAAAA,MAAM,CAACK,IAAP,GAAcC,IAAI,CAACC,SAAL,CAAeP,MAAM,CAACK,IAAtB,CAAd;AACAL,EAAAA,MAAM,CAACQ,OAAP,GAAiB;AACf,oBAAgB,kBADD;AAEf,eAAWN,KAFI;AAGf,iBAAaE,IAAI,CAACK;AAHH,GAAjB;AAKA,SAAOT,MAAP;AACD,CAdH,EAeE,UAAAU,KAAK,EAAI;AACPd,EAAAA,YAAY;;AACZ,WAAQ;AACNe,IAAAA,SAAS,EAAE,IADL;AAENC,IAAAA,OAAO,EAAEF,KAFH;AAGNG,IAAAA,IAAI,EAAE;AAHA,GAAR;;AAKA,SAAOH,KAAP;AACD,CAvBH,E,CA0BA;;AACA5B,OAAO,CAACe,YAAR,CAAqBiB,QAArB,CAA8Bf,GAA9B,CACE,UAAAe,QAAQ,EAAI;AACVlB,EAAAA,YAAY;;AAEZ,MAAIkB,QAAQ,CAACN,OAAT,CAAiB,WAAjB,CAAJ,EAAmC;AACjC5B,IAAAA,KAAK,CAACmC,MAAN,CAAa,eAAb,EAA8BD,QAAQ,CAACN,OAAT,CAAiB,WAAjB,CAA9B;AACD;;AACD,MAAIM,QAAQ,CAACT,IAAT,CAAcW,IAAd,KAAuB,CAAvB,IAA4BF,QAAQ,CAACN,OAAT,CAAiBS,OAAjB,KAA6B,MAA7D,EAAqE;AACnE,WAAOH,QAAQ,CAACT,IAAhB;AACD,GAFD,MAEO;AACL,aAAQ;AACNM,MAAAA,SAAS,EAAE,IADL;AAENC,MAAAA,OAAO,EAAEE,QAAQ,CAACT,IAAT,CAAca,GAAd,IAAqBC,SAAS,CAACL,QAAQ,CAACN,OAAT,CAAiBU,GAAlB,CAFjC;AAGNL,MAAAA,IAAI,EAAEC,QAAQ,CAACN,OAAT,CAAiBY,OAAjB,IAA4B;AAH5B,KAAR;;AAKA,QAAIN,QAAQ,CAACT,IAAT,CAAcA,IAAd,IAAsBS,QAAQ,CAACT,IAAT,CAAcA,IAAd,CAAmBgB,MAA7C,EAAqD;AACnDzC,MAAAA,KAAK,CAACmC,MAAN,CAAa,eAAb;AACD;;AACD,WAAOD,QAAQ,CAACT,IAAT,CAAca,GAAd,GAAoBJ,QAAQ,CAACT,IAA7B,GAAoCS,QAA3C;AACD;AACF,CApBH,EAqBE,UAAAJ,KAAK,EAAI;AACPd,EAAAA,YAAY;;AACZ,cAAW0B,OAAX,8DACYZ,KADZ,qfAIG,MAJH,EAIW;AACTa,IAAAA,wBAAwB,EAAE,IADjB;AAETC,IAAAA,yBAAyB,EAAE,IAFlB;AAGTC,IAAAA,iBAAiB,EAAE,MAHV;AAITC,IAAAA,gBAAgB,EAAE;AAJT,GAJX,EAUGC,IAVH,CAUQ,YAAM;AACV/C,IAAAA,KAAK,CAACmC,MAAN,CAAa,eAAb;AACD,GAZH;;AAaA,SAAOL,KAAP;AACD,CArCH;AAwCA,eAAe5B,OAAf","sourcesContent":["import axios from 'axios' // 引入axios\r\nimport { Message } from 'element-ui'\r\nimport { store } from '@/store'\r\nimport context from '@/main'\r\nimport { MessageBox } from 'element-ui'\r\n\r\nconst service = axios.create({\r\n  baseURL: process.env.VUE_APP_BASE_API,\r\n  timeout: 99999\r\n})\r\nlet acitveAxios = 0\r\nlet timer\r\nconst showLoading = () => {\r\n  acitveAxios++\r\n  if (timer) {\r\n    clearTimeout(timer)\r\n  }\r\n  timer = setTimeout(() => {\r\n    if (acitveAxios > 0) {\r\n      context.$bus.emit('showLoading')\r\n    }\r\n  }, 400)\r\n}\r\n\r\nconst closeLoading = () => {\r\n  acitveAxios--\r\n  if (acitveAxios <= 0) {\r\n    clearTimeout(timer)\r\n    context.$bus.emit('closeLoading')\r\n  }\r\n}\r\n// http request 拦截器\r\nservice.interceptors.request.use(\r\n  config => {\r\n    if (!config.donNotShowLoading) {\r\n      showLoading()\r\n    }\r\n    const token = store.getters['user/token']\r\n    const user = store.getters['user/userInfo']\r\n    config.data = JSON.stringify(config.data)\r\n    config.headers = {\r\n      'Content-Type': 'application/json',\r\n      'x-token': token,\r\n      'x-user-id': user.ID\r\n    }\r\n    return config\r\n  },\r\n  error => {\r\n    closeLoading()\r\n    Message({\r\n      showClose: true,\r\n      message: error,\r\n      type: 'error'\r\n    })\r\n    return error\r\n  }\r\n)\r\n\r\n// http response 拦截器\r\nservice.interceptors.response.use(\r\n  response => {\r\n    closeLoading()\r\n\r\n    if (response.headers['new-token']) {\r\n      store.commit('user/setToken', response.headers['new-token'])\r\n    }\r\n    if (response.data.code === 0 || response.headers.success === 'true') {\r\n      return response.data\r\n    } else {\r\n      Message({\r\n        showClose: true,\r\n        message: response.data.msg || decodeURI(response.headers.msg),\r\n        type: response.headers.msgtype || 'error'\r\n      })\r\n      if (response.data.data && response.data.data.reload) {\r\n        store.commit('user/LoginOut')\r\n      }\r\n      return response.data.msg ? response.data : response\r\n    }\r\n  },\r\n  error => {\r\n    closeLoading()\r\n    MessageBox.confirm(`\r\n    <p>检测到接口错误${error}</p>\r\n    <p>错误码500：此类错误内容常见于后台panic，如果影响您正常使用可强制登出清理缓存</p>\r\n    <p>错误码404：此类错误多为接口未注册（或未重启）或者请求路径（方法）与api路径（方法）不符</p>\r\n    `, '接口报错', {\r\n      dangerouslyUseHTMLString: true,\r\n      distinguishCancelAndClose: true,\r\n      confirmButtonText: '清理缓存',\r\n      cancelButtonText: '取消'\r\n    })\r\n      .then(() => {\r\n        store.commit('user/LoginOut')\r\n      })\r\n    return error\r\n  }\r\n)\r\n\r\nexport default service\r\n"]}]}