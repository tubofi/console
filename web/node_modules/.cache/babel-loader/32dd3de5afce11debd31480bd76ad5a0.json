{"remainingRequest":"E:\\临时文件夹\\console\\web\\node_modules\\babel-loader\\lib\\index.js!E:\\临时文件夹\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\临时文件夹\\console\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\临时文件夹\\console\\web\\src\\view\\superAdmin\\authority\\components\\menus.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\临时文件夹\\console\\web\\src\\view\\superAdmin\\authority\\components\\menus.vue","mtime":1625854608000},{"path":"E:\\临时文件夹\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\临时文件夹\\console\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\临时文件夹\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\临时文件夹\\console\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29tZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJFOi9cdTRFMzRcdTY1RjZcdTY1ODdcdTRFRjZcdTU5MzkvY29uc29sZS93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBnZXRCYXNlTWVudVRyZWUsIGdldE1lbnVBdXRob3JpdHksIGFkZE1lbnVBdXRob3JpdHkgfSBmcm9tICdAL2FwaS9tZW51JzsKaW1wb3J0IHsgdXBkYXRlQXV0aG9yaXR5IH0gZnJvbSAnQC9hcGkvYXV0aG9yaXR5JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdNZW51cycsCiAgcHJvcHM6IHsKICAgIHJvdzogewogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0sCiAgICAgIHR5cGU6IE9iamVjdAogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1lbnVUcmVlRGF0YTogW10sCiAgICAgIG1lbnVUcmVlSWRzOiBbXSwKICAgICAgbmVlZENvbmZpcm06IGZhbHNlLAogICAgICBtZW51RGVmYXVsdFByb3BzOiB7CiAgICAgICAgY2hpbGRyZW46ICdjaGlsZHJlbicsCiAgICAgICAgbGFiZWw6IGZ1bmN0aW9uIGxhYmVsKGRhdGEpIHsKICAgICAgICAgIHJldHVybiBkYXRhLm1ldGEudGl0bGU7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIHJlcywgcmVzMSwgbWVudXMsIGFycjsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBnZXRCYXNlTWVudVRyZWUoKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIF90aGlzLm1lbnVUcmVlRGF0YSA9IHJlcy5kYXRhLm1lbnVzOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiBnZXRNZW51QXV0aG9yaXR5KHsKICAgICAgICAgICAgICAgIGF1dGhvcml0eUlkOiBfdGhpcy5yb3cuYXV0aG9yaXR5SWQKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICByZXMxID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBtZW51cyA9IHJlczEuZGF0YS5tZW51czsKICAgICAgICAgICAgICBhcnIgPSBbXTsKICAgICAgICAgICAgICBtZW51cy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgIC8vIOmYsuatouebtOaOpemAieS4reeItue6p+mAoOaIkOWFqOmAiQogICAgICAgICAgICAgICAgaWYgKCFtZW51cy5zb21lKGZ1bmN0aW9uIChzYW1lKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBzYW1lLnBhcmVudElkID09PSBpdGVtLm1lbnVJZDsKICAgICAgICAgICAgICAgIH0pKSB7CiAgICAgICAgICAgICAgICAgIGFyci5wdXNoKE51bWJlcihpdGVtLm1lbnVJZCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF90aGlzLm1lbnVUcmVlSWRzID0gYXJyOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNldERlZmF1bHQ6IGZ1bmN0aW9uIHNldERlZmF1bHQoZGF0YSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciByZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBdXRob3JpdHkoewogICAgICAgICAgICAgICAgICBhdXRob3JpdHlJZDogX3RoaXMyLnJvdy5hdXRob3JpdHlJZCwKICAgICAgICAgICAgICAgICAgQXV0aG9yaXR5TmFtZTogX3RoaXMyLnJvdy5hdXRob3JpdHlOYW1lLAogICAgICAgICAgICAgICAgICBwYXJlbnRJZDogX3RoaXMyLnJvdy5wYXJlbnRJZCwKICAgICAgICAgICAgICAgICAgZGVmYXVsdFJvdXRlcjogZGF0YS5uYW1lCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMi4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICforr7nva7miJDlip8nCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyLnJvdy5kZWZhdWx0Um91dGVyID0gcmVzLmRhdGEuYXV0aG9yaXR5LmRlZmF1bHRSb3V0ZXI7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG5vZGVDaGFuZ2U6IGZ1bmN0aW9uIG5vZGVDaGFuZ2UoKSB7CiAgICAgIHRoaXMubmVlZENvbmZpcm0gPSB0cnVlOwogICAgfSwKICAgIC8vIOaatOmcsue7meWkluWxguS9v+eUqOeahOWIh+aNouaLpuaIque7n+S4gOaWueazlQogICAgZW50ZXJBbmROZXh0OiBmdW5jdGlvbiBlbnRlckFuZE5leHQoKSB7CiAgICAgIHRoaXMucmVsYXRpb24oKTsKICAgIH0sCiAgICAvLyDlhbPogZTmoJEg56Gu6K6k5pa55rOVCiAgICByZWxhdGlvbjogZnVuY3Rpb24gcmVsYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIGNoZWNrQXJyLCByZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNoZWNrQXJyID0gX3RoaXMzLiRyZWZzLm1lbnVUcmVlLmdldENoZWNrZWROb2RlcyhmYWxzZSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gYWRkTWVudUF1dGhvcml0eSh7CiAgICAgICAgICAgICAgICAgIG1lbnVzOiBjaGVja0FyciwKICAgICAgICAgICAgICAgICAgYXV0aG9yaXR5SWQ6IF90aGlzMy5yb3cuYXV0aG9yaXR5SWQKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+iPnOWNleiuvue9ruaIkOWKnyEnCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["menus.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div class=\"clearflex\">\n      <el-button class=\"fl-right\" size=\"small\" type=\"primary\" @click=\"relation\">确 定</el-button>\n    </div>\n    <el-tree\n      ref=\"menuTree\"\n      :data=\"menuTreeData\"\n      :default-checked-keys=\"menuTreeIds\"\n      :props=\"menuDefaultProps\"\n      default-expand-all\n      highlight-current\n      node-key=\"ID\"\n      show-checkbox\n      @check=\"nodeChange\"\n    >\n      <span slot-scope=\"{ node , data }\" class=\"custom-tree-node\">\n        <span>{{ node.label }}</span>\n        <span>\n          <el-button\n            type=\"text\"\n            size=\"mini\"\n            :style=\"{color:row.defaultRouter === data.name?'#E6A23C':'#85ce61'}\"\n            :disabled=\"!node.checked\"\n            @click=\"() => setDefault(data)\"\n          >\n            {{ row.defaultRouter === data.name?\"首页\":\"设为首页\" }}\n          </el-button>\n        </span>\n      </span>\n    </el-tree>\n  </div>\n</template>\n\n<script>\nimport { getBaseMenuTree, getMenuAuthority, addMenuAuthority } from '@/api/menu'\nimport {\n  updateAuthority\n} from '@/api/authority'\nexport default {\n  name: 'Menus',\n  props: {\n    row: {\n      default: function() {\n        return {}\n      },\n      type: Object\n    }\n  },\n  data() {\n    return {\n      menuTreeData: [],\n      menuTreeIds: [],\n      needConfirm: false,\n      menuDefaultProps: {\n        children: 'children',\n        label: function(data) {\n          return data.meta.title\n        }\n      }\n    }\n  },\n  async created() {\n    // 获取所有菜单树\n    const res = await getBaseMenuTree()\n    this.menuTreeData = res.data.menus\n\n    const res1 = await getMenuAuthority({ authorityId: this.row.authorityId })\n    const menus = res1.data.menus\n    const arr = []\n    menus.map(item => {\n      // 防止直接选中父级造成全选\n      if (!menus.some(same => same.parentId === item.menuId)) {\n        arr.push(Number(item.menuId))\n      }\n    })\n    this.menuTreeIds = arr\n  },\n  methods: {\n    async setDefault(data) {\n      const res = await updateAuthority({ authorityId: this.row.authorityId, AuthorityName: this.row.authorityName, parentId: this.row.parentId, defaultRouter: data.name })\n      if (res.code === 0) {\n        this.$message({ type: 'success', message: '设置成功' })\n        this.row.defaultRouter = res.data.authority.defaultRouter\n      }\n    },\n    nodeChange() {\n      this.needConfirm = true\n    },\n    // 暴露给外层使用的切换拦截统一方法\n    enterAndNext() {\n      this.relation()\n    },\n    // 关联树 确认方法\n    async relation() {\n      const checkArr = this.$refs.menuTree.getCheckedNodes(false, true)\n      const res = await addMenuAuthority({\n        menus: checkArr,\n        authorityId: this.row.authorityId\n      })\n      if (res.code === 0) {\n        this.$message({\n          type: 'success',\n          message: '菜单设置成功!'\n        })\n      }\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/view/superAdmin/authority/components"}]}