{"remainingRequest":"E:\\临时文件夹\\console\\web\\node_modules\\babel-loader\\lib\\index.js!E:\\临时文件夹\\console\\web\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\临时文件夹\\console\\web\\src\\utils\\image.js","dependencies":[{"path":"E:\\临时文件夹\\console\\web\\src\\utils\\image.js","mtime":1625854608000},{"path":"E:\\临时文件夹\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\临时文件夹\\console\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\临时文件夹\\console\\web\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXktYnVmZmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXktYnVmZmVyLnNsaWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnVpbnQ4LWFycmF5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuY29weS13aXRoaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5ldmVyeSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbGwiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWx0ZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuam9pbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lmxhc3QtaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UtcmlnaHQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZXZlcnNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2V0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zb21lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29ydCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnN1YmFycmF5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tbG9jYWxlLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRTovXHU0RTM0XHU2NUY2XHU2NTg3XHU0RUY2XHU1OTM5L2NvbnNvbGUvd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRTovXHU0RTM0XHU2NUY2XHU2NTg3XHU0RUY2XHU1OTM5L2NvbnNvbGUvd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7Cgp2YXIgSW1hZ2VDb21wcmVzcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gSW1hZ2VDb21wcmVzcyhmaWxlLCBmaWxlU2l6ZSkgewogICAgdmFyIG1heFdIID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAxOTIwOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbWFnZUNvbXByZXNzKTsKCiAgICB0aGlzLmZpbGUgPSBmaWxlOwogICAgdGhpcy5maWxlU2l6ZSA9IGZpbGVTaXplOwogICAgdGhpcy5tYXhXSCA9IG1heFdIOyAvLyDmnIDlpKfplb/lrr0KICB9CgogIF9jcmVhdGVDbGFzcyhJbWFnZUNvbXByZXNzLCBbewogICAga2V5OiAiY29tcHJlc3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXByZXNzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy8g5Y6L57ypCiAgICAgIHZhciBmaWxlVHlwZSA9IHRoaXMuZmlsZS50eXBlOwogICAgICB2YXIgZmlsZVNpemUgPSB0aGlzLmZpbGUuc2l6ZSAvIDEwMjQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKF90aGlzLmZpbGUpOwoKICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICAgICAgdmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOwogICAgICAgICAgaW1nLnNyYyA9IHJlYWRlci5yZXN1bHQ7CgogICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwoKICAgICAgICAgICAgdmFyIF9kV0ggPSBfdGhpcy5kV0goaW1nLndpZHRoLCBpbWcuaGVpZ2h0LCBfdGhpcy5tYXhXSCk7CgogICAgICAgICAgICBjYW52YXMud2lkdGggPSBfZFdILndpZHRoOwogICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gX2RXSC5oZWlnaHQ7IC8vIOa4heepuuWQjiwg6YeN5YaZ55S75biDCgogICAgICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7CiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwogICAgICAgICAgICB2YXIgbmV3SW1nRGF0YSA9IGNhbnZhcy50b0RhdGFVUkwoZmlsZVR5cGUsIDAuOTApOyAvLyDljovnvKnlrr3pq5jlkI7nmoTlm77lg4/lpKflsI8KCiAgICAgICAgICAgIHZhciBuZXdJbWdTaXplID0gX3RoaXMuZmlsZVNpemVLQihuZXdJbWdEYXRhKTsKCiAgICAgICAgICAgIGlmIChuZXdJbWdTaXplID4gX3RoaXMuZmlsZVNpemUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5Zu+54mH5bC65a+45aSq5aSnIScgKyBmaWxlU2l6ZSArICcgPj4gJyArIG5ld0ltZ1NpemUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgYmxvYiA9IF90aGlzLmRhdGFVUkx0b0Jsb2IobmV3SW1nRGF0YSwgZmlsZVR5cGUpOwoKICAgICAgICAgICAgdmFyIG5maWxlID0gbmV3IEZpbGUoW2Jsb2JdLCBfdGhpcy5maWxlLm5hbWUpOwogICAgICAgICAgICByZXNvbHZlKG5maWxlKTsKICAgICAgICAgIH07CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIOmVv+WuveetieavlOe8qeWwjwogICAgICog5Zu+5YOP55qE5LiA6L65KOmVv+aIluWuvSnkuLrmnIDlpKfnm67moIflgLwKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkV0giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRXSChzcmNXLCBzcmNILCBkTWF4KSB7CiAgICAgIHZhciBkZWZhdWx0cyA9IHsKICAgICAgICB3aWR0aDogc3JjVywKICAgICAgICBoZWlnaHQ6IHNyY0gKICAgICAgfTsKCiAgICAgIGlmIChNYXRoLm1heChzcmNXLCBzcmNIKSA+IGRNYXgpIHsKICAgICAgICBpZiAoc3JjVyA+IHNyY0gpIHsKICAgICAgICAgIGRlZmF1bHRzLndpZHRoID0gZE1heDsKICAgICAgICAgIGRlZmF1bHRzLmhlaWdodCA9IE1hdGgucm91bmQoc3JjSCAqIChkTWF4IC8gc3JjVykpOwogICAgICAgICAgcmV0dXJuIGRlZmF1bHRzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkZWZhdWx0cy5oZWlnaHQgPSBkTWF4OwogICAgICAgICAgZGVmYXVsdHMud2lkdGggPSBNYXRoLnJvdW5kKHNyY1cgKiAoZE1heCAvIHNyY0gpKTsKICAgICAgICAgIHJldHVybiBkZWZhdWx0czsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRzOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZmlsZVNpemVLQiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsZVNpemVLQihkYXRhVVJMKSB7CiAgICAgIHZhciBzaXplS0IgPSAwOwogICAgICBzaXplS0IgPSBNYXRoLnJvdW5kKGRhdGFVUkwuc3BsaXQoJywnKVsxXS5sZW5ndGggKiAzIC8gNCAvIDEwMjQpOwogICAgICByZXR1cm4gc2l6ZUtCOwogICAgfQogICAgLyoqCiAgICAgKiDovazkuLpCbG9iCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGF0YVVSTHRvQmxvYiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGF0YVVSTHRvQmxvYihkYXRhVVJMLCBmaWxlVHlwZSkgewogICAgICB2YXIgYnl0ZVN0cmluZyA9IGF0b2IoZGF0YVVSTC5zcGxpdCgnLCcpWzFdKTsKICAgICAgdmFyIG1pbWVTdHJpbmcgPSBkYXRhVVJMLnNwbGl0KCcsJylbMF0uc3BsaXQoJzonKVsxXS5zcGxpdCgnOycpWzBdOwogICAgICB2YXIgYWIgPSBuZXcgQXJyYXlCdWZmZXIoYnl0ZVN0cmluZy5sZW5ndGgpOwogICAgICB2YXIgaWEgPSBuZXcgVWludDhBcnJheShhYik7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVTdHJpbmcubGVuZ3RoOyBpKyspIHsKICAgICAgICBpYVtpXSA9IGJ5dGVTdHJpbmcuY2hhckNvZGVBdChpKTsKICAgICAgfQoKICAgICAgaWYgKGZpbGVUeXBlKSB7CiAgICAgICAgbWltZVN0cmluZyA9IGZpbGVUeXBlOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IEJsb2IoW2FiXSwgewogICAgICAgIHR5cGU6IG1pbWVTdHJpbmcsCiAgICAgICAgbGFzdE1vZGlmaWVkRGF0ZTogbmV3IERhdGUoKQogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBJbWFnZUNvbXByZXNzOwp9KCk7CgpleHBvcnQgeyBJbWFnZUNvbXByZXNzIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["E:/临时文件夹/console/web/src/utils/image.js"],"names":["ImageCompress","file","fileSize","maxWH","fileType","type","size","Promise","resolve","reader","FileReader","readAsDataURL","onload","canvas","document","createElement","img","src","result","ctx","getContext","_dWH","dWH","width","height","clearRect","drawImage","newImgData","toDataURL","newImgSize","fileSizeKB","console","log","blob","dataURLtoBlob","nfile","File","name","srcW","srcH","dMax","defaults","Math","max","round","dataURL","sizeKB","split","length","byteString","atob","mimeString","ab","ArrayBuffer","ia","Uint8Array","i","charCodeAt","Blob","lastModifiedDate","Date"],"mappings":"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","sourcesContent":["export default class ImageCompress {\n  constructor(file, fileSize, maxWH = 1920) {\n    this.file = file\n    this.fileSize = fileSize\n    this.maxWH = maxWH // 最大长宽\n  }\n\n  compress() {\n    // 压缩\n    const fileType = this.file.type\n    const fileSize = this.file.size / 1024\n    return new Promise(resolve => {\n      const reader = new FileReader()\n      reader.readAsDataURL(this.file)\n      reader.onload = () => {\n        const canvas = document.createElement('canvas')\n        const img = document.createElement('img')\n        img.src = reader.result\n        img.onload = () => {\n          const ctx = canvas.getContext('2d')\n          const _dWH = this.dWH(img.width, img.height, this.maxWH)\n          canvas.width = _dWH.width\n          canvas.height = _dWH.height\n\n          // 清空后, 重写画布\n          ctx.clearRect(0, 0, canvas.width, canvas.height)\n          ctx.drawImage(img, 0, 0, canvas.width, canvas.height)\n\n          const newImgData = canvas.toDataURL(fileType, 0.90)\n\n          // 压缩宽高后的图像大小\n          const newImgSize = this.fileSizeKB(newImgData)\n\n          if (newImgSize > this.fileSize) {\n            console.log('图片尺寸太大!' + fileSize + ' >> ' + newImgSize)\n          }\n\n          const blob = this.dataURLtoBlob(newImgData, fileType)\n          const nfile = new File([blob], this.file.name)\n          resolve(nfile)\n        }\n      }\n    })\n  }\n\n  /**\n   * 长宽等比缩小\n   * 图像的一边(长或宽)为最大目标值\n   */\n  dWH(srcW, srcH, dMax) {\n    const defaults = {\n      width: srcW,\n      height: srcH\n    }\n    if (Math.max(srcW, srcH) > dMax) {\n      if (srcW > srcH) {\n        defaults.width = dMax\n        defaults.height = Math.round(srcH * (dMax / srcW))\n        return defaults\n      } else {\n        defaults.height = dMax\n        defaults.width = Math.round(srcW * (dMax / srcH))\n        return defaults\n      }\n    } else {\n      return defaults\n    }\n  }\n\n  fileSizeKB(dataURL) {\n    let sizeKB = 0\n    sizeKB = Math.round((dataURL.split(',')[1].length * 3 / 4) / 1024)\n    return sizeKB\n  }\n\n  /**\n   * 转为Blob\n   */\n  dataURLtoBlob(dataURL, fileType) {\n    const byteString = atob(dataURL.split(',')[1])\n    let mimeString = dataURL.split(',')[0].split(':')[1].split(';')[0]\n    const ab = new ArrayBuffer(byteString.length)\n    const ia = new Uint8Array(ab)\n    for (let i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i)\n    }\n    if (fileType) {\n      mimeString = fileType\n    }\n    return new Blob([ab], { type: mimeString, lastModifiedDate: new Date() })\n  }\n}\n"]}]}