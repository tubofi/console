{"remainingRequest":"E:\\console\\web\\node_modules\\babel-loader\\lib\\index.js!E:\\console\\web\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\console\\web\\src\\api\\excel.js","dependencies":[{"path":"E:\\console\\web\\src\\api\\excel.js","mtime":1625854608000},{"path":"E:\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\console\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\console\\web\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsIjsKaW1wb3J0IF9NZXNzYWdlMiBmcm9tICJlbGVtZW50LXVpL2xpYi90aGVtZS1jaGFsay9tZXNzYWdlLmNzcyI7CmltcG9ydCAiZWxlbWVudC11aS9saWIvdGhlbWUtY2hhbGsvYmFzZS5jc3MiOwppbXBvcnQgX01lc3NhZ2UgZnJvbSAiZWxlbWVudC11aS9saWIvbWVzc2FnZSI7CmltcG9ydCBzZXJ2aWNlIGZyb20gJ0AvdXRpbHMvcmVxdWVzdCc7Cgp2YXIgaGFuZGxlRmlsZUVycm9yID0gZnVuY3Rpb24gaGFuZGxlRmlsZUVycm9yKHJlcywgZmlsZU5hbWUpIHsKICBpZiAodHlwZW9mIHJlcy5kYXRhICE9PSAndW5kZWZpbmVkJykgewogICAgaWYgKHJlcy5kYXRhLnR5cGUgPT09ICdhcHBsaWNhdGlvbi9qc29uJykgewogICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCiAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKHJlYWRlci5yZXN1bHQpLm1zZzsKCiAgICAgICAgX01lc3NhZ2UoewogICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSwKICAgICAgICAgIHR5cGU6ICdlcnJvcicKICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgIHJlYWRlci5yZWFkQXNUZXh0KG5ldyBCbG9iKFtyZXMuZGF0YV0pKTsKICAgIH0KICB9IGVsc2UgewogICAgdmFyIGRvd25sb2FkVXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3Jlc10pKTsKICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgYS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgYS5ocmVmID0gZG93bmxvYWRVcmw7CiAgICBhLmRvd25sb2FkID0gZmlsZU5hbWU7CiAgICB2YXIgZXZlbnQgPSBuZXcgTW91c2VFdmVudCgnY2xpY2snKTsKICAgIGEuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgfQp9OyAvLyBAVGFncyBleGNlbAovLyBAU3VtbWFyeSDlr7zlh7pFeGNlbAovLyBAU2VjdXJpdHkgQXBpS2V5QXV0aAovLyBAYWNjZXB0IGFwcGxpY2F0aW9uL2pzb24KLy8gQFByb2R1Y2UgIGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbQovLyBAUGFyYW0gZGF0YSBib2R5IG1vZGVsLkV4Y2VsSW5mbyB0cnVlICLlr7zlh7pFeGNlbOaWh+S7tuS/oeaBryIKLy8gQFN1Y2Nlc3MgMjAwCi8vIEBSb3V0ZXIgL2V4Y2VsL2V4cG9ydEV4Y2VsIFtwb3N0XQoKCmV4cG9ydCB2YXIgZXhwb3J0RXhjZWwgPSBmdW5jdGlvbiBleHBvcnRFeGNlbCh0YWJsZURhdGEsIGZpbGVOYW1lKSB7CiAgc2VydmljZSh7CiAgICB1cmw6ICcvZXhjZWwvZXhwb3J0RXhjZWwnLAogICAgbWV0aG9kOiAncG9zdCcsCiAgICBkYXRhOiB7CiAgICAgIGZpbGVOYW1lOiBmaWxlTmFtZSwKICAgICAgaW5mb0xpc3Q6IHRhYmxlRGF0YQogICAgfSwKICAgIHJlc3BvbnNlVHlwZTogJ2Jsb2InCiAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICBoYW5kbGVGaWxlRXJyb3IocmVzLCBmaWxlTmFtZSk7CiAgfSk7Cn07IC8vIEBUYWdzIGV4Y2VsCi8vIEBTdW1tYXJ5IOWvvOWFpUV4Y2Vs5paH5Lu2Ci8vIEBTZWN1cml0eSBBcGlLZXlBdXRoCi8vIEBhY2NlcHQgbXVsdGlwYXJ0L2Zvcm0tZGF0YQovLyBAUHJvZHVjZSAgYXBwbGljYXRpb24vanNvbgovLyBAUGFyYW0gZmlsZSBmb3JtRGF0YSBmaWxlIHRydWUgIuWvvOWFpUV4Y2Vs5paH5Lu2IgovLyBAU3VjY2VzcyAyMDAge3N0cmluZ30gc3RyaW5nICJ7InN1Y2Nlc3MiOnRydWUsImRhdGEiOnt9LCJtc2ciOiLlr7zlhaXmiJDlip8ifSIKLy8gQFJvdXRlciAvZXhjZWwvaW1wb3J0RXhjZWwgW3Bvc3RdCgpleHBvcnQgdmFyIGxvYWRFeGNlbERhdGEgPSBmdW5jdGlvbiBsb2FkRXhjZWxEYXRhKCkgewogIHJldHVybiBzZXJ2aWNlKHsKICAgIHVybDogJy9leGNlbC9sb2FkRXhjZWwnLAogICAgbWV0aG9kOiAnZ2V0JwogIH0pOwp9OyAvLyBAVGFncyBleGNlbAovLyBAU3VtbWFyeSDkuIvovb3mqKHmnb8KLy8gQFNlY3VyaXR5IEFwaUtleUF1dGgKLy8gQGFjY2VwdCBtdWx0aXBhcnQvZm9ybS1kYXRhCi8vIEBQcm9kdWNlICBhcHBsaWNhdGlvbi9qc29uCi8vIEBQYXJhbSBmaWxlTmFtZSBxdWVyeSBmaWxlTmFtZSB0cnVlICLmqKHmnb/lkI3np7AiCi8vIEBTdWNjZXNzIDIwMAovLyBAUm91dGVyIC9leGNlbC9kb3dubG9hZFRlbXBsYXRlIFtnZXRdCgpleHBvcnQgdmFyIGRvd25sb2FkVGVtcGxhdGUgPSBmdW5jdGlvbiBkb3dubG9hZFRlbXBsYXRlKGZpbGVOYW1lKSB7CiAgcmV0dXJuIHNlcnZpY2UoewogICAgdXJsOiAnL2V4Y2VsL2Rvd25sb2FkVGVtcGxhdGUnLAogICAgbWV0aG9kOiAnZ2V0JywKICAgIHBhcmFtczogewogICAgICBmaWxlTmFtZTogZmlsZU5hbWUKICAgIH0sCiAgICByZXNwb25zZVR5cGU6ICdibG9iJwogIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgaGFuZGxlRmlsZUVycm9yKHJlcywgZmlsZU5hbWUpOwogIH0pOwp9Ow=="},{"version":3,"sources":["E:/console/web/src/api/excel.js"],"names":["service","handleFileError","res","fileName","data","type","reader","FileReader","onload","message","JSON","parse","result","msg","showClose","readAsText","Blob","downloadUrl","window","URL","createObjectURL","a","document","createElement","style","display","href","download","event","MouseEvent","dispatchEvent","exportExcel","tableData","url","method","infoList","responseType","then","loadExcelData","downloadTemplate","params"],"mappings":";;;;;;;AAAA,OAAOA,OAAP,MAAoB,iBAApB;;AAGA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,GAAD,EAAMC,QAAN,EAAmB;AACzC,MAAI,OAAQD,GAAG,CAACE,IAAZ,KAAsB,WAA1B,EAAuC;AACrC,QAAIF,GAAG,CAACE,IAAJ,CAASC,IAAT,KAAkB,kBAAtB,EAA0C;AACxC,UAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;;AACAD,MAAAA,MAAM,CAACE,MAAP,GAAgB,YAAW;AACzB,YAAMC,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWL,MAAM,CAACM,MAAlB,EAA0BC,GAA1C;;AACA,iBAAQ;AACNC,UAAAA,SAAS,EAAE,IADL;AAENL,UAAAA,OAAO,EAAEA,OAFH;AAGNJ,UAAAA,IAAI,EAAE;AAHA,SAAR;AAKD,OAPD;;AAQAC,MAAAA,MAAM,CAACS,UAAP,CAAkB,IAAIC,IAAJ,CAAS,CAACd,GAAG,CAACE,IAAL,CAAT,CAAlB;AACD;AACF,GAbD,MAaO;AACL,QAAIa,WAAW,GAAGC,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2B,IAAIJ,IAAJ,CAAS,CAACd,GAAD,CAAT,CAA3B,CAAlB;AACA,QAAImB,CAAC,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAR;AACAF,IAAAA,CAAC,CAACG,KAAF,CAAQC,OAAR,GAAkB,MAAlB;AACAJ,IAAAA,CAAC,CAACK,IAAF,GAAST,WAAT;AACAI,IAAAA,CAAC,CAACM,QAAF,GAAaxB,QAAb;AACA,QAAIyB,KAAK,GAAG,IAAIC,UAAJ,CAAe,OAAf,CAAZ;AACAR,IAAAA,CAAC,CAACS,aAAF,CAAgBF,KAAhB;AACD;AACF,CAvBD,C,CAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,OAAO,IAAMG,WAAW,GAAG,SAAdA,WAAc,CAACC,SAAD,EAAY7B,QAAZ,EAAyB;AAClDH,EAAAA,OAAO,CAAC;AACNiC,IAAAA,GAAG,EAAE,oBADC;AAENC,IAAAA,MAAM,EAAE,MAFF;AAGN9B,IAAAA,IAAI,EAAE;AACJD,MAAAA,QAAQ,EAAEA,QADN;AAEJgC,MAAAA,QAAQ,EAAEH;AAFN,KAHA;AAONI,IAAAA,YAAY,EAAE;AAPR,GAAD,CAAP,CAQGC,IARH,CAQQ,UAACnC,GAAD,EAAS;AACfD,IAAAA,eAAe,CAACC,GAAD,EAAMC,QAAN,CAAf;AACD,GAVD;AAWD,CAZM,C,CAcP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,IAAMmC,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AACjC,SAAOtC,OAAO,CAAC;AACbiC,IAAAA,GAAG,EAAE,kBADQ;AAEbC,IAAAA,MAAM,EAAE;AAFK,GAAD,CAAd;AAID,CALM,C,CAOP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,IAAMK,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACpC,QAAD,EAAc;AAC5C,SAAOH,OAAO,CAAC;AACbiC,IAAAA,GAAG,EAAE,yBADQ;AAEbC,IAAAA,MAAM,EAAE,KAFK;AAGbM,IAAAA,MAAM,EAAE;AACNrC,MAAAA,QAAQ,EAAEA;AADJ,KAHK;AAMbiC,IAAAA,YAAY,EAAE;AAND,GAAD,CAAP,CAOJC,IAPI,CAOC,UAACnC,GAAD,EAAS;AACfD,IAAAA,eAAe,CAACC,GAAD,EAAMC,QAAN,CAAf;AACD,GATM,CAAP;AAUD,CAXM","sourcesContent":["import service from '@/utils/request'\nimport { Message } from 'element-ui'\n\nconst handleFileError = (res, fileName) => {\n  if (typeof (res.data) !== 'undefined') {\n    if (res.data.type === 'application/json') {\n      const reader = new FileReader()\n      reader.onload = function() {\n        const message = JSON.parse(reader.result).msg\n        Message({\n          showClose: true,\n          message: message,\n          type: 'error'\n        })\n      }\n      reader.readAsText(new Blob([res.data]))\n    }\n  } else {\n    var downloadUrl = window.URL.createObjectURL(new Blob([res]))\n    var a = document.createElement('a')\n    a.style.display = 'none'\n    a.href = downloadUrl\n    a.download = fileName\n    var event = new MouseEvent('click')\n    a.dispatchEvent(event)\n  }\n}\n\n// @Tags excel\n// @Summary 导出Excel\n// @Security ApiKeyAuth\n// @accept application/json\n// @Produce  application/octet-stream\n// @Param data body model.ExcelInfo true \"导出Excel文件信息\"\n// @Success 200\n// @Router /excel/exportExcel [post]\nexport const exportExcel = (tableData, fileName) => {\n  service({\n    url: '/excel/exportExcel',\n    method: 'post',\n    data: {\n      fileName: fileName,\n      infoList: tableData\n    },\n    responseType: 'blob'\n  }).then((res) => {\n    handleFileError(res, fileName)\n  })\n}\n\n// @Tags excel\n// @Summary 导入Excel文件\n// @Security ApiKeyAuth\n// @accept multipart/form-data\n// @Produce  application/json\n// @Param file formData file true \"导入Excel文件\"\n// @Success 200 {string} string \"{\"success\":true,\"data\":{},\"msg\":\"导入成功\"}\"\n// @Router /excel/importExcel [post]\nexport const loadExcelData = () => {\n  return service({\n    url: '/excel/loadExcel',\n    method: 'get'\n  })\n}\n\n// @Tags excel\n// @Summary 下载模板\n// @Security ApiKeyAuth\n// @accept multipart/form-data\n// @Produce  application/json\n// @Param fileName query fileName true \"模板名称\"\n// @Success 200\n// @Router /excel/downloadTemplate [get]\nexport const downloadTemplate = (fileName) => {\n  return service({\n    url: '/excel/downloadTemplate',\n    method: 'get',\n    params: {\n      fileName: fileName\n    },\n    responseType: 'blob'\n  }).then((res) => {\n    handleFileError(res, fileName)\n  })\n}\n"]}]}