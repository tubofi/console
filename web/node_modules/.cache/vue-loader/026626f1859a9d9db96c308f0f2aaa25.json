{"remainingRequest":"E:\\临时\\console\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\临时\\console\\web\\src\\view\\superAdmin\\operation\\sysOperationRecord.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\临时\\console\\web\\src\\view\\superAdmin\\operation\\sysOperationRecord.vue","mtime":1625854608000},{"path":"E:\\临时\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\临时\\console\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\临时\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\临时\\console\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgZGVsZXRlU3lzT3BlcmF0aW9uUmVjb3JkLAogIGdldFN5c09wZXJhdGlvblJlY29yZExpc3QsCiAgZGVsZXRlU3lzT3BlcmF0aW9uUmVjb3JkQnlJZHMKfSBmcm9tICdAL2FwaS9zeXNPcGVyYXRpb25SZWNvcmQnIC8vIOatpOWkhOivt+iHquihjOabv+aNouWcsOWdgAppbXBvcnQgeyBmb3JtYXRUaW1lVG9TdHIgfSBmcm9tICdAL3V0aWxzL2RhdGUnCmltcG9ydCBpbmZvTGlzdCBmcm9tICdAL21peGlucy9pbmZvTGlzdCcKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU3lzT3BlcmF0aW9uUmVjb3JkJywKICBmaWx0ZXJzOiB7CiAgICBmb3JtYXREYXRlOiBmdW5jdGlvbih0aW1lKSB7CiAgICAgIGlmICh0aW1lICE9PSBudWxsICYmIHRpbWUgIT09ICcnKSB7CiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSh0aW1lKQogICAgICAgIHJldHVybiBmb3JtYXRUaW1lVG9TdHIoZGF0ZSwgJ3l5eXktTU0tZGQgaGg6bW06c3MnKQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnJwogICAgICB9CiAgICB9LAogICAgZm9ybWF0Qm9vbGVhbjogZnVuY3Rpb24oYm9vbCkgewogICAgICBpZiAoYm9vbCAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiBib29sID8gJ+aYrycgOiAn5ZCmJwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnJwogICAgICB9CiAgICB9CiAgfSwKICBtaXhpbnM6IFtpbmZvTGlzdF0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3RBcGk6IGdldFN5c09wZXJhdGlvblJlY29yZExpc3QsCiAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlOiBmYWxzZSwKICAgICAgdHlwZTogJycsCiAgICAgIGRlbGV0ZVZpc2libGU6IGZhbHNlLAogICAgICBtdWx0aXBsZVNlbGVjdGlvbjogW10sCiAgICAgIGZvcm1EYXRhOiB7CiAgICAgICAgaXA6IG51bGwsCiAgICAgICAgbWV0aG9kOiBudWxsLAogICAgICAgIHBhdGg6IG51bGwsCiAgICAgICAgc3RhdHVzOiBudWxsLAogICAgICAgIGxhdGVuY3k6IG51bGwsCiAgICAgICAgYWdlbnQ6IG51bGwsCiAgICAgICAgZXJyb3JfbWVzc2FnZTogbnVsbCwKICAgICAgICB1c2VyX2lkOiBudWxsCiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldFRhYmxlRGF0YSgpCiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDmnaHku7bmkJzntKLliY3nq6/nnIvmraTmlrnms5UKICAgIG9uU3VibWl0KCkgewogICAgICB0aGlzLnBhZ2UgPSAxCiAgICAgIHRoaXMucGFnZVNpemUgPSAxMAogICAgICB0aGlzLmdldFRhYmxlRGF0YSgpCiAgICB9LAogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHZhbCkgewogICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uID0gdmFsCiAgICB9LAogICAgYXN5bmMgb25EZWxldGUoKSB7CiAgICAgIGNvbnN0IGlkcyA9IFtdCiAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb24gJiYKICAgICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uLm1hcChpdGVtID0+IHsKICAgICAgICAgIGlkcy5wdXNoKGl0ZW0uSUQpCiAgICAgICAgfSkKICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGVsZXRlU3lzT3BlcmF0aW9uUmVjb3JkQnlJZHMoeyBpZHMgfSkKICAgICAgaWYgKHJlcy5jb2RlID09PSAwKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICBtZXNzYWdlOiAn5Yig6Zmk5oiQ5YqfJwogICAgICAgIH0pCiAgICAgICAgaWYgKHRoaXMudGFibGVEYXRhLmxlbmd0aCA9PT0gaWRzLmxlbmd0aCAmJiB0aGlzLnBhZ2UgPiAxKSB7CiAgICAgICAgICB0aGlzLnBhZ2UtLQogICAgICAgIH0KICAgICAgICB0aGlzLmRlbGV0ZVZpc2libGUgPSBmYWxzZQogICAgICAgIHRoaXMuZ2V0VGFibGVEYXRhKCkKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGRlbGV0ZVN5c09wZXJhdGlvblJlY29yZChyb3cpIHsKICAgICAgcm93LnZpc2libGUgPSBmYWxzZQogICAgICBjb25zdCByZXMgPSBhd2FpdCBkZWxldGVTeXNPcGVyYXRpb25SZWNvcmQoeyBJRDogcm93LklEIH0pCiAgICAgIGlmIChyZXMuY29kZSA9PT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOaIkOWKnycKICAgICAgICB9KQogICAgICAgIGlmICh0aGlzLnRhYmxlRGF0YS5sZW5ndGggPT09IDEgJiYgdGhpcy5wYWdlID4gMSkgewogICAgICAgICAgdGhpcy5wYWdlLS0KICAgICAgICB9CiAgICAgICAgdGhpcy5nZXRUYWJsZURhdGEoKQogICAgICB9CiAgICB9LAogICAgZm10Qm9keSh2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIHJldHVybiBKU09OLnBhcnNlKHZhbHVlKQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["sysOperationRecord.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"sysOperationRecord.vue","sourceRoot":"src/view/superAdmin/operation","sourcesContent":["<template>\n  <div>\n    <div class=\"search-term\">\n      <el-form :inline=\"true\" :model=\"searchInfo\" class=\"demo-form-inline\">\n        <el-form-item label=\"请求方法\">\n          <el-input v-model=\"searchInfo.method\" placeholder=\"搜索条件\" />\n        </el-form-item>\n        <el-form-item label=\"请求路径\">\n          <el-input v-model=\"searchInfo.path\" placeholder=\"搜索条件\" />\n        </el-form-item>\n        <el-form-item label=\"结果状态码\">\n          <el-input v-model=\"searchInfo.status\" placeholder=\"搜索条件\" />\n        </el-form-item>\n        <el-form-item>\n          <el-button size=\"mini\" type=\"primary\" icon=\"el-icon-search\" @click=\"onSubmit\">查询</el-button>\n          <el-popover v-model=\"deleteVisible\" placement=\"top\" width=\"160\">\n            <p>确定要删除吗？</p>\n            <div style=\"text-align: right; margin: 0\">\n              <el-button size=\"mini\" type=\"text\" @click=\"deleteVisible = false\">取消</el-button>\n              <el-button size=\"mini\" type=\"primary\" @click=\"onDelete\">确定</el-button>\n            </div>\n            <el-button slot=\"reference\" icon=\"el-icon-delete\" size=\"mini\" type=\"danger\" style=\"margin-left: 10px;\">批量删除</el-button>\n          </el-popover>\n        </el-form-item>\n      </el-form>\n    </div>\n    <el-table\n      ref=\"multipleTable\"\n      :data=\"tableData\"\n      border\n      stripe\n      style=\"width: 100%\"\n      tooltip-effect=\"dark\"\n      @selection-change=\"handleSelectionChange\"\n    >\n      <el-table-column type=\"selection\" width=\"55\" />\n      <el-table-column label=\"操作人\" width=\"140\">\n        <template slot-scope=\"scope\">\n          <div>{{ scope.row.user.userName }}({{ scope.row.user.nickName }})</div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"日期\" width=\"180\">\n        <template slot-scope=\"scope\">{{ scope.row.CreatedAt|formatDate }}</template>\n      </el-table-column>\n      <el-table-column label=\"状态码\" prop=\"status\" width=\"120\">\n        <template slot-scope=\"scope\">\n          <div>\n            <el-tag type=\"success\">{{ scope.row.status }}</el-tag>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"请求ip\" prop=\"ip\" width=\"120\" />\n      <el-table-column label=\"请求方法\" prop=\"method\" width=\"120\" />\n      <el-table-column label=\"请求路径\" prop=\"path\" width=\"240\" />\n      <el-table-column label=\"请求\" prop=\"path\" width=\"80\">\n        <template slot-scope=\"scope\">\n          <div>\n            <el-popover v-if=\"scope.row.body\" placement=\"top-start\" trigger=\"hover\">\n              <div class=\"popover-box\">\n                <pre>{{ fmtBody(scope.row.body) }}</pre>\n              </div>\n              <i slot=\"reference\" class=\"el-icon-view\" />\n            </el-popover>\n\n            <span v-else>无</span>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"响应\" prop=\"path\" width=\"80\">\n        <template slot-scope=\"scope\">\n          <div>\n            <el-popover v-if=\"scope.row.resp\" placement=\"top-start\" trigger=\"hover\">\n              <div class=\"popover-box\">\n                <pre>{{ fmtBody(scope.row.resp) }}</pre>\n              </div>\n              <i slot=\"reference\" class=\"el-icon-view\" />\n            </el-popover>\n            <span v-else>无</span>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"按钮组\">\n        <template slot-scope=\"scope\">\n          <el-popover v-model=\"scope.row.visible\" placement=\"top\" width=\"160\">\n            <p>确定要删除吗？</p>\n            <div style=\"text-align: right; margin: 0\">\n              <el-button size=\"mini\" type=\"text\" @click=\"scope.row.visible = false\">取消</el-button>\n              <el-button size=\"mini\" type=\"primary\" @click=\"deleteSysOperationRecord(scope.row)\">确定</el-button>\n            </div>\n            <el-button slot=\"reference\" icon=\"el-icon-delete\" size=\"mini\" type=\"danger\">删除</el-button>\n          </el-popover>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-pagination\n      :current-page=\"page\"\n      :page-size=\"pageSize\"\n      :page-sizes=\"[10, 30, 50, 100]\"\n      :style=\"{float:'right',padding:'20px'}\"\n      :total=\"total\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n      @current-change=\"handleCurrentChange\"\n      @size-change=\"handleSizeChange\"\n    />\n  </div>\n</template>\n\n<script>\nimport {\n  deleteSysOperationRecord,\n  getSysOperationRecordList,\n  deleteSysOperationRecordByIds\n} from '@/api/sysOperationRecord' // 此处请自行替换地址\nimport { formatTimeToStr } from '@/utils/date'\nimport infoList from '@/mixins/infoList'\n\nexport default {\n  name: 'SysOperationRecord',\n  filters: {\n    formatDate: function(time) {\n      if (time !== null && time !== '') {\n        var date = new Date(time)\n        return formatTimeToStr(date, 'yyyy-MM-dd hh:mm:ss')\n      } else {\n        return ''\n      }\n    },\n    formatBoolean: function(bool) {\n      if (bool !== null) {\n        return bool ? '是' : '否'\n      } else {\n        return ''\n      }\n    }\n  },\n  mixins: [infoList],\n  data() {\n    return {\n      listApi: getSysOperationRecordList,\n      dialogFormVisible: false,\n      type: '',\n      deleteVisible: false,\n      multipleSelection: [],\n      formData: {\n        ip: null,\n        method: null,\n        path: null,\n        status: null,\n        latency: null,\n        agent: null,\n        error_message: null,\n        user_id: null\n      }\n    }\n  },\n  created() {\n    this.getTableData()\n  },\n  methods: {\n    // 条件搜索前端看此方法\n    onSubmit() {\n      this.page = 1\n      this.pageSize = 10\n      this.getTableData()\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val\n    },\n    async onDelete() {\n      const ids = []\n      this.multipleSelection &&\n        this.multipleSelection.map(item => {\n          ids.push(item.ID)\n        })\n      const res = await deleteSysOperationRecordByIds({ ids })\n      if (res.code === 0) {\n        this.$message({\n          type: 'success',\n          message: '删除成功'\n        })\n        if (this.tableData.length === ids.length && this.page > 1) {\n          this.page--\n        }\n        this.deleteVisible = false\n        this.getTableData()\n      }\n    },\n    async deleteSysOperationRecord(row) {\n      row.visible = false\n      const res = await deleteSysOperationRecord({ ID: row.ID })\n      if (res.code === 0) {\n        this.$message({\n          type: 'success',\n          message: '删除成功'\n        })\n        if (this.tableData.length === 1 && this.page > 1) {\n          this.page--\n        }\n        this.getTableData()\n      }\n    },\n    fmtBody(value) {\n      try {\n        return JSON.parse(value)\n      } catch (err) {\n        return value\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.table-expand {\n  padding-left: 60px;\n  font-size: 0;\n  label {\n    width: 90px;\n    color: #99a9bf;\n    .el-form-item {\n      margin-right: 0;\n      margin-bottom: 0;\n      width: 50%;\n    }\n  }\n}\n.popover-box {\n  background: #112435;\n  color: #f08047;\n  height: 600px;\n  width: 420px;\n  overflow: auto;\n}\n.popover-box::-webkit-scrollbar {\n  display: none; /* Chrome Safari */\n}\n</style>\n"]}]}