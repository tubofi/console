{"remainingRequest":"E:\\临时\\console\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\临时\\console\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\临时\\console\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue","mtime":1625854608000},{"path":"E:\\临时\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\临时\\console\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\临时\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\临时\\console\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHNldERhdGFBdXRob3JpdHkgfSBmcm9tICdAL2FwaS9hdXRob3JpdHknCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRGF0YXMnLAogIHByb3BzOiB7CiAgICByb3c6IHsKICAgICAgZGVmYXVsdDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHt9CiAgICAgIH0sCiAgICAgIHR5cGU6IE9iamVjdAogICAgfSwKICAgIGF1dGhvcml0eTogewogICAgICBkZWZhdWx0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4ge30KICAgICAgfSwKICAgICAgdHlwZTogQXJyYXkKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhdXRob3JpdHlzOiBbXSwKICAgICAgZGF0YUF1dGhvcml0eUlkOiBbXSwKICAgICAgbmVlZENvbmZpcm06IGZhbHNlCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5hdXRob3JpdHlzID0gW10KICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gW10KICAgIHRoaXMucm91bmRBdXRob3JpdHkodGhpcy5hdXRob3JpdHkpCiAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgJiYgdGhpcy5yb3cuZGF0YUF1dGhvcml0eUlkLm1hcChpdGVtID0+IHsKICAgICAgY29uc3Qgb2JqID0gdGhpcy5hdXRob3JpdHlzICYmIHRoaXMuYXV0aG9yaXR5cy5maWx0ZXIoYXUgPT4gYXUuYXV0aG9yaXR5SWQgPT09IGl0ZW0uYXV0aG9yaXR5SWQpICYmIHRoaXMuYXV0aG9yaXR5cy5maWx0ZXIoYXUgPT4gYXUuYXV0aG9yaXR5SWQgPT09IGl0ZW0uYXV0aG9yaXR5SWQpWzBdCiAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkLnB1c2gob2JqKQogICAgfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOaatOmcsue7meWkluWxguS9v+eUqOeahOWIh+aNouaLpuaIque7n+S4gOaWueazlQogICAgZW50ZXJBbmROZXh0KCkgewogICAgICB0aGlzLmF1dGhEYXRhRW50ZXIoKQogICAgfSwKICAgIGFsbCgpIHsKICAgICAgdGhpcy5kYXRhQXV0aG9yaXR5SWQgPSBbLi4udGhpcy5hdXRob3JpdHlzXQogICAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmRhdGFBdXRob3JpdHlJZAogICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQogICAgfSwKICAgIHNlbGYoKSB7CiAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5hdXRob3JpdHlzLmZpbHRlcihpdGVtID0+IGl0ZW0uYXV0aG9yaXR5SWQgPT09IHRoaXMucm93LmF1dGhvcml0eUlkKQogICAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmRhdGFBdXRob3JpdHlJZAogICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQogICAgfSwKICAgIHNlbGZBbmRDaGlsZHJlbigpIHsKICAgICAgY29uc3QgYXJyQm94ID0gW10KICAgICAgdGhpcy5nZXRDaGlsZHJlbklkKHRoaXMucm93LCBhcnJCb3gpCiAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5hdXRob3JpdHlzLmZpbHRlcihpdGVtID0+IGFyckJveC5pbmRleE9mKGl0ZW0uYXV0aG9yaXR5SWQpID4gLTEpCiAgICAgIHRoaXMucm93LmRhdGFBdXRob3JpdHlJZCA9IHRoaXMuZGF0YUF1dGhvcml0eUlkCiAgICAgIHRoaXMubmVlZENvbmZpcm0gPSB0cnVlCiAgICB9LAogICAgZ2V0Q2hpbGRyZW5JZChyb3csIGFyckJveCkgewogICAgICBhcnJCb3gucHVzaChyb3cuYXV0aG9yaXR5SWQpCiAgICAgIHJvdy5jaGlsZHJlbiAmJiByb3cuY2hpbGRyZW4ubWFwKGl0ZW0gPT4gewogICAgICAgIHRoaXMuZ2V0Q2hpbGRyZW5JZChpdGVtLCBhcnJCb3gpCiAgICAgIH0pCiAgICB9LAogICAgLy8g5o+Q5LqkCiAgICBhc3luYyBhdXRoRGF0YUVudGVyKCkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCBzZXREYXRhQXV0aG9yaXR5KHRoaXMucm93KQogICAgICBpZiAocmVzLmNvZGUgPT09IDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsgdHlwZTogJ3N1Y2Nlc3MnLCBtZXNzYWdlOiAn6LWE5rqQ6K6+572u5oiQ5YqfJyB9KQogICAgICB9CiAgICB9LAogICAgLy8gICDlubPpk7rop5LoibIKICAgIHJvdW5kQXV0aG9yaXR5KGF1dGhvcml0eXMpIHsKICAgICAgYXV0aG9yaXR5cyAmJiBhdXRob3JpdHlzLm1hcChpdGVtID0+IHsKICAgICAgICBjb25zdCBvYmogPSB7fQogICAgICAgIG9iai5hdXRob3JpdHlJZCA9IGl0ZW0uYXV0aG9yaXR5SWQKICAgICAgICBvYmouYXV0aG9yaXR5TmFtZSA9IGl0ZW0uYXV0aG9yaXR5TmFtZQogICAgICAgIHRoaXMuYXV0aG9yaXR5cy5wdXNoKG9iaikKICAgICAgICBpZiAoaXRlbS5jaGlsZHJlbiAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5yb3VuZEF1dGhvcml0eShpdGVtLmNoaWxkcmVuKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyAgIOmAieaLqQogICAgc2VsZWN0QXV0aG9yaXR5KCkgewogICAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmRhdGFBdXRob3JpdHlJZAogICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQogICAgfQogIH0KfQo="},{"version":3,"sources":["datas.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"datas.vue","sourceRoot":"src/view/superAdmin/authority/components","sourcesContent":["<template>\n  <div>\n    <div class=\"clearflex\" style=\"margin:18px\">\n      <el-button class=\"fl-right\" size=\"small\" type=\"primary\" @click=\"authDataEnter\">确 定</el-button>\n      <el-button class=\"fl-left\" size=\"small\" type=\"primary\" @click=\"all\">全选</el-button>\n      <el-button class=\"fl-left\" size=\"small\" type=\"primary\" @click=\"self\">本角色</el-button>\n      <el-button class=\"fl-left\" size=\"small\" type=\"primary\" @click=\"selfAndChildren\">本角色及子角色</el-button>\n    </div>\n    <el-checkbox-group v-model=\"dataAuthorityId\" @change=\"selectAuthority\">\n      <el-checkbox v-for=\"(item,key) in authoritys\" :key=\"key\" :label=\"item\">{{ item.authorityName }}</el-checkbox>\n    </el-checkbox-group>\n  </div>\n</template>\n\n<script>\nimport { setDataAuthority } from '@/api/authority'\nexport default {\n  name: 'Datas',\n  props: {\n    row: {\n      default: function() {\n        return {}\n      },\n      type: Object\n    },\n    authority: {\n      default: function() {\n        return {}\n      },\n      type: Array\n    }\n  },\n  data() {\n    return {\n      authoritys: [],\n      dataAuthorityId: [],\n      needConfirm: false\n    }\n  },\n  created() {\n    this.authoritys = []\n    this.dataAuthorityId = []\n    this.roundAuthority(this.authority)\n    this.row.dataAuthorityId && this.row.dataAuthorityId.map(item => {\n      const obj = this.authoritys && this.authoritys.filter(au => au.authorityId === item.authorityId) && this.authoritys.filter(au => au.authorityId === item.authorityId)[0]\n      this.dataAuthorityId.push(obj)\n    })\n  },\n  methods: {\n    // 暴露给外层使用的切换拦截统一方法\n    enterAndNext() {\n      this.authDataEnter()\n    },\n    all() {\n      this.dataAuthorityId = [...this.authoritys]\n      this.row.dataAuthorityId = this.dataAuthorityId\n      this.needConfirm = true\n    },\n    self() {\n      this.dataAuthorityId = this.authoritys.filter(item => item.authorityId === this.row.authorityId)\n      this.row.dataAuthorityId = this.dataAuthorityId\n      this.needConfirm = true\n    },\n    selfAndChildren() {\n      const arrBox = []\n      this.getChildrenId(this.row, arrBox)\n      this.dataAuthorityId = this.authoritys.filter(item => arrBox.indexOf(item.authorityId) > -1)\n      this.row.dataAuthorityId = this.dataAuthorityId\n      this.needConfirm = true\n    },\n    getChildrenId(row, arrBox) {\n      arrBox.push(row.authorityId)\n      row.children && row.children.map(item => {\n        this.getChildrenId(item, arrBox)\n      })\n    },\n    // 提交\n    async authDataEnter() {\n      const res = await setDataAuthority(this.row)\n      if (res.code === 0) {\n        this.$message({ type: 'success', message: '资源设置成功' })\n      }\n    },\n    //   平铺角色\n    roundAuthority(authoritys) {\n      authoritys && authoritys.map(item => {\n        const obj = {}\n        obj.authorityId = item.authorityId\n        obj.authorityName = item.authorityName\n        this.authoritys.push(obj)\n        if (item.children && item.children.length) {\n          this.roundAuthority(item.children)\n        }\n      })\n    },\n    //   选择\n    selectAuthority() {\n      this.row.dataAuthorityId = this.dataAuthorityId\n      this.needConfirm = true\n    }\n  }\n}\n</script>\n"]}]}