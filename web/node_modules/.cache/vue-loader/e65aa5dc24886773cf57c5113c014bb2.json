{"remainingRequest":"E:\\console\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\console\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\console\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue","mtime":1629645124118},{"path":"E:\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1629645113861},{"path":"E:\\console\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":1629645113236},{"path":"E:\\console\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1629645113861},{"path":"E:\\console\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":1629645123321}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBzZXREYXRhQXV0aG9yaXR5IH0gZnJvbSAnQC9hcGkvYXV0aG9yaXR5Jw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnRGF0YXMnLA0KICBwcm9wczogew0KICAgIHJvdzogew0KICAgICAgZGVmYXVsdDogZnVuY3Rpb24oKSB7DQogICAgICAgIHJldHVybiB7fQ0KICAgICAgfSwNCiAgICAgIHR5cGU6IE9iamVjdA0KICAgIH0sDQogICAgYXV0aG9yaXR5OiB7DQogICAgICBkZWZhdWx0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgcmV0dXJuIHt9DQogICAgICB9LA0KICAgICAgdHlwZTogQXJyYXkNCiAgICB9DQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGF1dGhvcml0eXM6IFtdLA0KICAgICAgZGF0YUF1dGhvcml0eUlkOiBbXSwNCiAgICAgIG5lZWRDb25maXJtOiBmYWxzZQ0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmF1dGhvcml0eXMgPSBbXQ0KICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gW10NCiAgICB0aGlzLnJvdW5kQXV0aG9yaXR5KHRoaXMuYXV0aG9yaXR5KQ0KICAgIHRoaXMucm93LmRhdGFBdXRob3JpdHlJZCAmJiB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQubWFwKGl0ZW0gPT4gew0KICAgICAgY29uc3Qgb2JqID0gdGhpcy5hdXRob3JpdHlzICYmIHRoaXMuYXV0aG9yaXR5cy5maWx0ZXIoYXUgPT4gYXUuYXV0aG9yaXR5SWQgPT09IGl0ZW0uYXV0aG9yaXR5SWQpICYmIHRoaXMuYXV0aG9yaXR5cy5maWx0ZXIoYXUgPT4gYXUuYXV0aG9yaXR5SWQgPT09IGl0ZW0uYXV0aG9yaXR5SWQpWzBdDQogICAgICB0aGlzLmRhdGFBdXRob3JpdHlJZC5wdXNoKG9iaikNCiAgICB9KQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g5pq06Zyy57uZ5aSW5bGC5L2/55So55qE5YiH5o2i5oum5oiq57uf5LiA5pa55rOVDQogICAgZW50ZXJBbmROZXh0KCkgew0KICAgICAgdGhpcy5hdXRoRGF0YUVudGVyKCkNCiAgICB9LA0KICAgIGFsbCgpIHsNCiAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gWy4uLnRoaXMuYXV0aG9yaXR5c10NCiAgICAgIHRoaXMucm93LmRhdGFBdXRob3JpdHlJZCA9IHRoaXMuZGF0YUF1dGhvcml0eUlkDQogICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQ0KICAgIH0sDQogICAgc2VsZigpIHsNCiAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5hdXRob3JpdHlzLmZpbHRlcihpdGVtID0+IGl0ZW0uYXV0aG9yaXR5SWQgPT09IHRoaXMucm93LmF1dGhvcml0eUlkKQ0KICAgICAgdGhpcy5yb3cuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5kYXRhQXV0aG9yaXR5SWQNCiAgICAgIHRoaXMubmVlZENvbmZpcm0gPSB0cnVlDQogICAgfSwNCiAgICBzZWxmQW5kQ2hpbGRyZW4oKSB7DQogICAgICBjb25zdCBhcnJCb3ggPSBbXQ0KICAgICAgdGhpcy5nZXRDaGlsZHJlbklkKHRoaXMucm93LCBhcnJCb3gpDQogICAgICB0aGlzLmRhdGFBdXRob3JpdHlJZCA9IHRoaXMuYXV0aG9yaXR5cy5maWx0ZXIoaXRlbSA9PiBhcnJCb3guaW5kZXhPZihpdGVtLmF1dGhvcml0eUlkKSA+IC0xKQ0KICAgICAgdGhpcy5yb3cuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5kYXRhQXV0aG9yaXR5SWQNCiAgICAgIHRoaXMubmVlZENvbmZpcm0gPSB0cnVlDQogICAgfSwNCiAgICBnZXRDaGlsZHJlbklkKHJvdywgYXJyQm94KSB7DQogICAgICBhcnJCb3gucHVzaChyb3cuYXV0aG9yaXR5SWQpDQogICAgICByb3cuY2hpbGRyZW4gJiYgcm93LmNoaWxkcmVuLm1hcChpdGVtID0+IHsNCiAgICAgICAgdGhpcy5nZXRDaGlsZHJlbklkKGl0ZW0sIGFyckJveCkNCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDmj5DkuqQNCiAgICBhc3luYyBhdXRoRGF0YUVudGVyKCkgew0KICAgICAgY29uc3QgcmVzID0gYXdhaXQgc2V0RGF0YUF1dGhvcml0eSh0aGlzLnJvdykNCiAgICAgIGlmIChyZXMuY29kZSA9PT0gMCkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsgdHlwZTogJ3N1Y2Nlc3MnLCBtZXNzYWdlOiAn6LWE5rqQ6K6+572u5oiQ5YqfJyB9KQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8gICDlubPpk7rop5LoibINCiAgICByb3VuZEF1dGhvcml0eShhdXRob3JpdHlzKSB7DQogICAgICBhdXRob3JpdHlzICYmIGF1dGhvcml0eXMubWFwKGl0ZW0gPT4gew0KICAgICAgICBjb25zdCBvYmogPSB7fQ0KICAgICAgICBvYmouYXV0aG9yaXR5SWQgPSBpdGVtLmF1dGhvcml0eUlkDQogICAgICAgIG9iai5hdXRob3JpdHlOYW1lID0gaXRlbS5hdXRob3JpdHlOYW1lDQogICAgICAgIHRoaXMuYXV0aG9yaXR5cy5wdXNoKG9iaikNCiAgICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4gJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGgpIHsNCiAgICAgICAgICB0aGlzLnJvdW5kQXV0aG9yaXR5KGl0ZW0uY2hpbGRyZW4pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyAgIOmAieaLqQ0KICAgIHNlbGVjdEF1dGhvcml0eSgpIHsNCiAgICAgIHRoaXMucm93LmRhdGFBdXRob3JpdHlJZCA9IHRoaXMuZGF0YUF1dGhvcml0eUlkDQogICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["datas.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"datas.vue","sourceRoot":"src/view/superAdmin/authority/components","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"clearflex\" style=\"margin:18px\">\r\n      <el-button class=\"fl-right\" size=\"small\" type=\"primary\" @click=\"authDataEnter\">确 定</el-button>\r\n      <el-button class=\"fl-left\" size=\"small\" type=\"primary\" @click=\"all\">全选</el-button>\r\n      <el-button class=\"fl-left\" size=\"small\" type=\"primary\" @click=\"self\">本角色</el-button>\r\n      <el-button class=\"fl-left\" size=\"small\" type=\"primary\" @click=\"selfAndChildren\">本角色及子角色</el-button>\r\n    </div>\r\n    <el-checkbox-group v-model=\"dataAuthorityId\" @change=\"selectAuthority\">\r\n      <el-checkbox v-for=\"(item,key) in authoritys\" :key=\"key\" :label=\"item\">{{ item.authorityName }}</el-checkbox>\r\n    </el-checkbox-group>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { setDataAuthority } from '@/api/authority'\r\nexport default {\r\n  name: 'Datas',\r\n  props: {\r\n    row: {\r\n      default: function() {\r\n        return {}\r\n      },\r\n      type: Object\r\n    },\r\n    authority: {\r\n      default: function() {\r\n        return {}\r\n      },\r\n      type: Array\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      authoritys: [],\r\n      dataAuthorityId: [],\r\n      needConfirm: false\r\n    }\r\n  },\r\n  created() {\r\n    this.authoritys = []\r\n    this.dataAuthorityId = []\r\n    this.roundAuthority(this.authority)\r\n    this.row.dataAuthorityId && this.row.dataAuthorityId.map(item => {\r\n      const obj = this.authoritys && this.authoritys.filter(au => au.authorityId === item.authorityId) && this.authoritys.filter(au => au.authorityId === item.authorityId)[0]\r\n      this.dataAuthorityId.push(obj)\r\n    })\r\n  },\r\n  methods: {\r\n    // 暴露给外层使用的切换拦截统一方法\r\n    enterAndNext() {\r\n      this.authDataEnter()\r\n    },\r\n    all() {\r\n      this.dataAuthorityId = [...this.authoritys]\r\n      this.row.dataAuthorityId = this.dataAuthorityId\r\n      this.needConfirm = true\r\n    },\r\n    self() {\r\n      this.dataAuthorityId = this.authoritys.filter(item => item.authorityId === this.row.authorityId)\r\n      this.row.dataAuthorityId = this.dataAuthorityId\r\n      this.needConfirm = true\r\n    },\r\n    selfAndChildren() {\r\n      const arrBox = []\r\n      this.getChildrenId(this.row, arrBox)\r\n      this.dataAuthorityId = this.authoritys.filter(item => arrBox.indexOf(item.authorityId) > -1)\r\n      this.row.dataAuthorityId = this.dataAuthorityId\r\n      this.needConfirm = true\r\n    },\r\n    getChildrenId(row, arrBox) {\r\n      arrBox.push(row.authorityId)\r\n      row.children && row.children.map(item => {\r\n        this.getChildrenId(item, arrBox)\r\n      })\r\n    },\r\n    // 提交\r\n    async authDataEnter() {\r\n      const res = await setDataAuthority(this.row)\r\n      if (res.code === 0) {\r\n        this.$message({ type: 'success', message: '资源设置成功' })\r\n      }\r\n    },\r\n    //   平铺角色\r\n    roundAuthority(authoritys) {\r\n      authoritys && authoritys.map(item => {\r\n        const obj = {}\r\n        obj.authorityId = item.authorityId\r\n        obj.authorityName = item.authorityName\r\n        this.authoritys.push(obj)\r\n        if (item.children && item.children.length) {\r\n          this.roundAuthority(item.children)\r\n        }\r\n      })\r\n    },\r\n    //   选择\r\n    selectAuthority() {\r\n      this.row.dataAuthorityId = this.dataAuthorityId\r\n      this.needConfirm = true\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}